# Milestone v1.0: React Frontend Rebuild

**Status:** SHIPPED 2026-02-03
**Phases:** 1-5
**Total Plans:** 12

## Overview

Rebuild the workout video editor frontend from vanilla HTML/JS to React + Tailwind CSS, delivering a smooth mobile experience across 5 phases. Phase 1 establishes the foundation (Vite, React, TypeScript, Tailwind, Zustand) with mobile UX patterns. Phase 2 migrates the upload feature. Phase 3 tackles the complex timeline editor with Canvas integration, tagging drawer, and save flow. Phase 4 migrates the exercise library. Phase 5 adds PWA capabilities (installability, share target, offline).

## Phases

### Phase 1: Foundation & Design System

**Goal**: User can navigate a React app shell with dark theme and 44px+ touch targets
**Depends on**: Nothing (first phase)
**Plans**: 2 plans

Plans:
- [x] 01-01-PLAN.md — Vite + React + TypeScript + Tailwind setup with Flask proxy
- [x] 01-02-PLAN.md — App shell with tab navigation, Button component, and Zustand stores

**Key Deliverables:**
- Vite + React 19 + TypeScript project with Flask API proxy
- Tailwind CSS 4 with dark theme via @custom-variant
- BrowserRouter SPA with three routes (/, /editor, /library)
- BottomNav with NavLink active state highlighting
- Button component with 44px minimum touch targets (WCAG AAA)
- cn() utility for Tailwind class merging
- Zustand uiStore for UI state management

### Phase 2: Upload Feature

**Goal**: User can upload a video and see it processed for scene detection
**Depends on**: Phase 1
**Plans**: 1 plan

Plans:
- [x] 02-01-PLAN.md — Upload infrastructure (api, store, ProgressBar) + DropZone + UploadPage wiring

**Key Deliverables:**
- Drag-and-drop video upload with react-dropzone
- XHR upload with real progress tracking (fetch doesn't support upload progress)
- Upload state management with Zustand (idle, uploading, processing, complete, error)
- Automatic navigation to /editor with video URL and suggested cuts
- Hebrew UI with RTL support throughout

### Phase 3: Timeline Editor

**Goal**: User can edit cut points, preview segments, tag exercises, and save the timeline
**Depends on**: Phase 2
**Plans**: 5 plans

Plans:
- [x] 03-01-PLAN.md — Canvas timeline with Zustand store, dnd-kit dragging, and cut point rendering
- [x] 03-02-PLAN.md — Video player with custom controls and segment preview playback
- [x] 03-03-PLAN.md — Segment tagging drawer with shadcn/ui, autocomplete chips, and form
- [x] 03-04-PLAN.md — Save flow with progress modal and navigation to Library
- [x] 03-05-PLAN.md — UAT gap closure (drawer seekbar, autoplay parameter, touch targets)

**Key Deliverables:**
- Canvas timeline with high-DPI rendering and zoom controls (0.5x-3x)
- Cut point dragging with dnd-kit sensors (MouseSensor + TouchSensor)
- Video player with custom controls and segment boundary auto-stop
- Segment tagging drawer (vaul-based) with video preview
- AutocompleteChips component for muscle groups and equipment
- Save flow with 4-state modal (idle, confirming, saving, success/error)
- Auto-navigation to library after 2-second success delay

### Phase 4: Exercise Library

**Goal**: User can view, search, filter, play, edit, and delete saved exercises
**Depends on**: Phase 3
**Plans**: 2 plans

Plans:
- [x] 04-01-PLAN.md — Exercise store, API functions, grid layout, search and filter
- [x] 04-02-PLAN.md — Video autoplay with Intersection Observer, edit dialog, delete dialog

**Key Deliverables:**
- Exercise grid with responsive columns (1-2-3-4 by breakpoint)
- Search by name with auto-fetch on change
- Filter by muscle groups and equipment with toggle chips
- Video autoplay on scroll (Intersection Observer at 50% visibility)
- Edit dialog with exercise name, muscle groups, equipment
- Delete dialog with warning and exercise preview

### Phase 5: PWA Migration

**Goal**: User can install the app and share videos from gallery directly to it
**Depends on**: Phase 4
**Plans**: 2 plans

Plans:
- [x] 05-01-PLAN.md — VitePWA plugin config, custom service worker, app icons, update prompt
- [x] 05-02-PLAN.md — Web Share Target handler with IndexedDB storage and React integration

**Key Deliverables:**
- VitePWA with injectManifest strategy for custom service worker
- Workbox caching: NetworkFirst for API/videos, CacheFirst for images
- UpdatePrompt component for service worker update notifications
- Web Share Target API for receiving videos from gallery
- IndexedDB helpers (idb library) for service worker data transfer
- App.tsx shared video detection and upload flow integration

---

## Milestone Summary

**Key Decisions:**

| Decision | Rationale | Phase |
|----------|-----------|-------|
| Tailwind CSS 4 with @tailwindcss/vite plugin | No PostCSS/autoprefixer needed, modern approach | 01-01 |
| 44px minimum touch targets | WCAG AAA compliance for accessibility | 01-02 |
| XMLHttpRequest over fetch for uploads | fetch API doesn't support upload progress tracking | 02-01 |
| dnd-kit sensors: MouseSensor (5px) + TouchSensor (100ms) | Prevents accidental drags while remaining responsive | 03-01 |
| Media Fragments URI for video preview | Native browser support, no custom controls needed | 03-03 |
| Intersection Observer threshold: 0.5 | Triggers autoplay when video is meaningfully visible | 04-02 |
| injectManifest strategy for custom SW | Required for Share Target POST interception | 05-01 |
| idb library for IndexedDB | Type-safe wrapper with promise-based API | 05-02 |

**Issues Resolved:**

- Drawer video preview needed segment-relative seekbar (not native controls)
- Main player needed autoPlay=false while drawer needed autoPlay=true
- DraggableCutPoint needed opacity-0 to prevent duplicate circles on canvas
- TypeScript needed WebWorker lib for service worker types

**Technical Debt Incurred:**

- Button zoom instead of pinch-to-zoom (functionally equivalent)
- English text in LibraryPage/SearchFilters (should be Hebrew)
- Duration formatting duplicated across components

---

_For current project status, see .planning/ROADMAP.md (created for next milestone)_

---
*Archived: 2026-02-03 as part of v1.0 milestone completion*
