---
phase: 04-exercise-library
plan: 02
type: execute
wave: 2
depends_on: ["04-01"]
files_modified:
  - frontend/src/components/ui/dialog.tsx
  - frontend/src/components/library/ExerciseCard.tsx
  - frontend/src/components/library/EditExerciseDialog.tsx
  - frontend/src/components/library/DeleteConfirmDialog.tsx
  - frontend/src/pages/LibraryPage.tsx
autonomous: true

must_haves:
  truths:
    - "User can tap exercise card to play its video with autoplay"
    - "User can tap edit button and modify exercise name, muscle groups, and equipment"
    - "User can tap delete button and confirm deletion of exercise"
    - "Video pauses when scrolled out of view and plays when scrolled in"
  artifacts:
    - path: "frontend/src/components/ui/dialog.tsx"
      provides: "Shadcn Dialog component"
      exports: ["Dialog", "DialogContent", "DialogHeader", "DialogTitle"]
    - path: "frontend/src/components/library/EditExerciseDialog.tsx"
      provides: "Edit exercise modal"
      exports: ["EditExerciseDialog"]
    - path: "frontend/src/components/library/DeleteConfirmDialog.tsx"
      provides: "Delete confirmation modal"
      exports: ["DeleteConfirmDialog"]
    - path: "frontend/src/components/library/ExerciseCard.tsx"
      provides: "Exercise card with video autoplay"
      contains: "IntersectionObserver"
  key_links:
    - from: "frontend/src/pages/LibraryPage.tsx"
      to: "EditExerciseDialog"
      via: "import and state management"
      pattern: "EditExerciseDialog"
    - from: "frontend/src/pages/LibraryPage.tsx"
      to: "DeleteConfirmDialog"
      via: "import and state management"
      pattern: "DeleteConfirmDialog"
    - from: "frontend/src/components/library/ExerciseCard.tsx"
      to: "IntersectionObserver"
      via: "useEffect hook"
      pattern: "new IntersectionObserver"
---

<objective>
Add video playback with scroll-triggered autoplay, edit dialog, and delete confirmation to exercise library.

Purpose: Enable users to play exercise videos, edit metadata, and delete exercises (LIB-05, LIB-06, LIB-07).

Output: Exercise cards with video autoplay on scroll, edit exercise dialog with form, and delete confirmation dialog.
</objective>

<execution_context>
@C:\Users\OmriS\.claude\get-shit-done\workflows\execute-plan.md
@C:\Users\OmriS\.claude\get-shit-done\templates\summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-exercise-library/04-RESEARCH.md
@.planning/phases/04-exercise-library/04-01-SUMMARY.md (after Plan 01 completes)

Reference existing patterns:
@frontend/src/components/ui/drawer.tsx (Radix/Shadcn component pattern)
@frontend/src/components/tagging/AutocompleteChips.tsx (Chip input for editing)
@frontend/src/stores/exerciseStore.ts (Store actions for update/delete)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add shadcn Dialog component</name>
  <files>frontend/src/components/ui/dialog.tsx</files>
  <action>
Run shadcn CLI to add Dialog component:
```bash
cd frontend && npx shadcn@latest add dialog --yes
```

If the CLI fails or component already exists, create frontend/src/components/ui/dialog.tsx manually:

```typescript
import * as React from "react"
import * as DialogPrimitive from "@radix-ui/react-dialog"
import { X } from "lucide-react"

import { cn } from "@/lib/utils"

const Dialog = DialogPrimitive.Root

const DialogTrigger = DialogPrimitive.Trigger

const DialogPortal = DialogPrimitive.Portal

const DialogClose = DialogPrimitive.Close

const DialogOverlay = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Overlay
    ref={ref}
    className={cn(
      "fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",
      className
    )}
    {...props}
  />
))
DialogOverlay.displayName = DialogPrimitive.Overlay.displayName

const DialogContent = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>
>(({ className, children, ...props }, ref) => (
  <DialogPortal>
    <DialogOverlay />
    <DialogPrimitive.Content
      ref={ref}
      className={cn(
        "fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",
        className
      )}
      {...props}
    >
      {children}
      <DialogPrimitive.Close className="absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground">
        <X className="h-4 w-4" />
        <span className="sr-only">Close</span>
      </DialogPrimitive.Close>
    </DialogPrimitive.Content>
  </DialogPortal>
))
DialogContent.displayName = DialogPrimitive.Content.displayName

const DialogHeader = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      "flex flex-col space-y-1.5 text-center sm:text-left",
      className
    )}
    {...props}
  />
)
DialogHeader.displayName = "DialogHeader"

const DialogFooter = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      "flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",
      className
    )}
    {...props}
  />
)
DialogFooter.displayName = "DialogFooter"

const DialogTitle = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Title
    ref={ref}
    className={cn(
      "text-lg font-semibold leading-none tracking-tight",
      className
    )}
    {...props}
  />
))
DialogTitle.displayName = DialogPrimitive.Title.displayName

const DialogDescription = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Description
    ref={ref}
    className={cn("text-sm text-muted-foreground", className)}
    {...props}
  />
))
DialogDescription.displayName = DialogPrimitive.Description.displayName

export {
  Dialog,
  DialogPortal,
  DialogOverlay,
  DialogTrigger,
  DialogClose,
  DialogContent,
  DialogHeader,
  DialogFooter,
  DialogTitle,
  DialogDescription,
}
```

If @radix-ui/react-dialog is not installed:
```bash
cd frontend && npm install @radix-ui/react-dialog
```
  </action>
  <verify>
1. File exists: `frontend/src/components/ui/dialog.tsx`
2. TypeScript compiles: `cd frontend && npx tsc --noEmit`
  </verify>
  <done>Dialog component available for edit and delete modals</done>
</task>

<task type="auto">
  <name>Task 2: Update ExerciseCard with video autoplay on scroll</name>
  <files>frontend/src/components/library/ExerciseCard.tsx</files>
  <action>
Update frontend/src/components/library/ExerciseCard.tsx to add video playback with Intersection Observer:

```typescript
import { useRef, useEffect, useState } from 'react';
import { type Exercise } from '@/lib/api';
import { Edit2, Trash2, Play } from 'lucide-react';

interface ExerciseCardProps {
  exercise: Exercise;
  onEdit: (exercise: Exercise) => void;
  onDelete: (exercise: Exercise) => void;
}

function formatDuration(seconds: number): string {
  const mins = Math.floor(seconds / 60);
  const secs = Math.floor(seconds % 60);
  return `${mins}:${secs.toString().padStart(2, '0')}`;
}

export function ExerciseCard({ exercise, onEdit, onDelete }: ExerciseCardProps) {
  const videoRef = useRef<HTMLVideoElement>(null);
  const [isPlaying, setIsPlaying] = useState(false);
  const [showVideo, setShowVideo] = useState(false);

  // Intersection Observer for autoplay on scroll (per research)
  useEffect(() => {
    const video = videoRef.current;
    if (!video) return;

    const observer = new IntersectionObserver(
      ([entry]) => {
        if (entry.isIntersecting) {
          // Only autoplay when video is visible (muted required for autoplay)
          video.play()
            .then(() => setIsPlaying(true))
            .catch(() => {
              // Autoplay blocked - user needs to tap to play
              setIsPlaying(false);
            });
        } else if (!video.paused) {
          video.pause();
          setIsPlaying(false);
        }
      },
      { threshold: 0.5 } // 50% visible triggers play
    );

    observer.observe(video);
    return () => observer.disconnect();
  }, [showVideo]);

  const handleCardClick = () => {
    setShowVideo(true);
  };

  const handleVideoClick = (e: React.MouseEvent) => {
    e.stopPropagation();
    const video = videoRef.current;
    if (!video) return;

    if (video.paused) {
      video.play().then(() => setIsPlaying(true));
    } else {
      video.pause();
      setIsPlaying(false);
    }
  };

  return (
    <div className="bg-gray-900 rounded-xl overflow-hidden shadow-md hover:shadow-lg transition-all">
      {/* Video/Thumbnail Container */}
      <div
        className="relative aspect-video bg-gray-800 cursor-pointer"
        onClick={showVideo ? handleVideoClick : handleCardClick}
      >
        {showVideo ? (
          <>
            <video
              ref={videoRef}
              className="w-full h-full object-cover"
              muted
              loop
              playsInline
              src={exercise.video_url}
            />
            {/* Play/Pause overlay */}
            {!isPlaying && (
              <div className="absolute inset-0 flex items-center justify-center bg-black/30">
                <Play className="w-16 h-16 text-white/80" />
              </div>
            )}
          </>
        ) : (
          <>
            {/* Thumbnail with play button */}
            {exercise.thumbnail_url ? (
              <img
                src={exercise.thumbnail_url}
                alt={exercise.exercise_name}
                className="w-full h-full object-cover"
              />
            ) : (
              <div className="w-full h-full flex items-center justify-center text-gray-600">
                <span className="text-4xl"></span>
              </div>
            )}
            <div className="absolute inset-0 flex items-center justify-center bg-black/30 hover:bg-black/40 transition-colors">
              <Play className="w-16 h-16 text-white/80" />
            </div>
          </>
        )}
      </div>

      {/* Card Info */}
      <div className="p-4">
        <div className="flex justify-between items-start mb-2">
          <h3 className="text-lg font-bold text-white">{exercise.exercise_name}</h3>
          <div className="flex gap-1">
            <button
              onClick={(e) => {
                e.stopPropagation();
                onEdit(exercise);
              }}
              className="p-2 text-blue-400 hover:text-blue-300 hover:bg-gray-800 rounded-lg transition-colors min-w-[44px] min-h-[44px] flex items-center justify-center"
              aria-label="注专 转专"
            >
              <Edit2 className="w-5 h-5" />
            </button>
            <button
              onClick={(e) => {
                e.stopPropagation();
                onDelete(exercise);
              }}
              className="p-2 text-red-400 hover:text-red-300 hover:bg-gray-800 rounded-lg transition-colors min-w-[44px] min-h-[44px] flex items-center justify-center"
              aria-label="拽 转专"
            >
              <Trash2 className="w-5 h-5" />
            </button>
          </div>
        </div>

        <div className="text-sm text-gray-400 mb-3">
          憋 {formatDuration(exercise.duration)}
        </div>

        {/* Tags */}
        <div className="flex flex-wrap gap-2">
          {exercise.muscle_groups?.map((mg) => (
            <span
              key={mg}
              className="px-2 py-1 bg-blue-900/50 text-blue-300 rounded-full text-xs"
            >
              {mg}
            </span>
          ))}
          {exercise.equipment?.map((eq) => (
            <span
              key={eq}
              className="px-2 py-1 bg-yellow-900/50 text-yellow-300 rounded-full text-xs"
            >
              {eq}
            </span>
          ))}
        </div>
      </div>
    </div>
  );
}
```

Key implementation notes:
- `muted` attribute required for autoplay to work in browsers
- `playsInline` required for iOS
- `loop` for continuous playback
- Intersection Observer with 0.5 threshold (50% visible)
- Click thumbnail to show video, then video plays via observer
- Click video to toggle play/pause
- Cleanup observer on unmount
  </action>
  <verify>
1. TypeScript compiles: `cd frontend && npx tsc --noEmit`
2. Run dev server, navigate to Library
3. Click on exercise card thumbnail - video should appear and start playing
4. Scroll video out of view - should pause
5. Scroll video into view - should autoplay (muted)
  </verify>
  <done>Exercise cards have video playback with scroll-triggered autoplay</done>
</task>

<task type="auto">
  <name>Task 3: Create EditExerciseDialog and DeleteConfirmDialog, wire to LibraryPage</name>
  <files>
    frontend/src/components/library/EditExerciseDialog.tsx
    frontend/src/components/library/DeleteConfirmDialog.tsx
    frontend/src/pages/LibraryPage.tsx
  </files>
  <action>
1. Create frontend/src/components/library/EditExerciseDialog.tsx:

```typescript
import { useState, useEffect } from 'react';
import {
  Dialog,
  DialogContent,
  DialogHeader,
  DialogTitle,
} from '@/components/ui/dialog';
import { AutocompleteChips } from '@/components/tagging/AutocompleteChips';
import { type Exercise } from '@/lib/api';

interface EditExerciseDialogProps {
  exercise: Exercise | null;
  open: boolean;
  onOpenChange: (open: boolean) => void;
  allMuscleGroups: string[];
  allEquipment: string[];
  onSave: (
    id: number,
    data: { exercise_name: string; muscle_groups: string[]; equipment: string[] }
  ) => Promise<void>;
}

export function EditExerciseDialog({
  exercise,
  open,
  onOpenChange,
  allMuscleGroups,
  allEquipment,
  onSave,
}: EditExerciseDialogProps) {
  const [name, setName] = useState('');
  const [muscleGroups, setMuscleGroups] = useState<string[]>([]);
  const [equipment, setEquipment] = useState<string[]>([]);
  const [isSaving, setIsSaving] = useState(false);
  const [error, setError] = useState<string | null>(null);

  // Populate form when exercise changes
  useEffect(() => {
    if (exercise) {
      setName(exercise.exercise_name);
      setMuscleGroups(exercise.muscle_groups || []);
      setEquipment(exercise.equipment || []);
      setError(null);
    }
  }, [exercise]);

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    if (!exercise || !name.trim()) return;

    setIsSaving(true);
    setError(null);

    try {
      await onSave(exercise.id, {
        exercise_name: name.trim(),
        muscle_groups: muscleGroups,
        equipment: equipment,
      });
      onOpenChange(false);
    } catch (err) {
      setError('砖 砖专转 转专');
    } finally {
      setIsSaving(false);
    }
  };

  return (
    <Dialog open={open} onOpenChange={onOpenChange}>
      <DialogContent className="max-w-2xl bg-gray-900 border-gray-700" dir="rtl">
        <DialogHeader>
          <DialogTitle className="text-white">注专 转专</DialogTitle>
        </DialogHeader>

        <form onSubmit={handleSubmit} className="space-y-4">
          {/* Exercise Name */}
          <div>
            <label className="block text-sm font-medium text-gray-300 mb-2">
              砖 转专 *
            </label>
            <input
              type="text"
              value={name}
              onChange={(e) => setName(e.target.value)}
              required
              className="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white
                         placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500
                         min-h-[44px]"
              placeholder=": 住拽, 砖转 住"
            />
          </div>

          {/* Muscle Groups */}
          <AutocompleteChips
            label="拽爪转 砖专专 *"
            placeholder="拽 拽爪转 砖专专 拽砖 Enter"
            options={allMuscleGroups}
            value={muscleGroups}
            onChange={setMuscleGroups}
          />

          {/* Equipment */}
          <AutocompleteChips
            label="爪 专砖 *"
            placeholder="拽 爪 拽砖 Enter"
            options={allEquipment}
            value={equipment}
            onChange={setEquipment}
          />

          {/* Error message */}
          {error && (
            <p className="text-red-400 text-sm">{error}</p>
          )}

          {/* Actions */}
          <div className="flex justify-end gap-3 pt-4">
            <button
              type="button"
              onClick={() => onOpenChange(false)}
              disabled={isSaving}
              className="px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-700
                         disabled:opacity-50 transition-colors min-h-[44px]"
            >
              
            </button>
            <button
              type="submit"
              disabled={isSaving || !name.trim()}
              className="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700
                         disabled:opacity-50 transition-colors min-h-[44px]"
            >
              {isSaving ? '砖专...' : '砖专 砖'}
            </button>
          </div>
        </form>
      </DialogContent>
    </Dialog>
  );
}
```

2. Create frontend/src/components/library/DeleteConfirmDialog.tsx:

```typescript
import { useState } from 'react';
import {
  Dialog,
  DialogContent,
  DialogHeader,
  DialogTitle,
} from '@/components/ui/dialog';
import { type Exercise } from '@/lib/api';
import { AlertTriangle } from 'lucide-react';

interface DeleteConfirmDialogProps {
  exercise: Exercise | null;
  open: boolean;
  onOpenChange: (open: boolean) => void;
  onConfirm: (id: number) => Promise<void>;
}

export function DeleteConfirmDialog({
  exercise,
  open,
  onOpenChange,
  onConfirm,
}: DeleteConfirmDialogProps) {
  const [isDeleting, setIsDeleting] = useState(false);
  const [error, setError] = useState<string | null>(null);

  const handleConfirm = async () => {
    if (!exercise) return;

    setIsDeleting(true);
    setError(null);

    try {
      await onConfirm(exercise.id);
      onOpenChange(false);
    } catch (err) {
      setError('砖 拽转 转专');
    } finally {
      setIsDeleting(false);
    }
  };

  return (
    <Dialog open={open} onOpenChange={onOpenChange}>
      <DialogContent className="max-w-md bg-gray-900 border-gray-700" dir="rtl">
        <div className="text-center">
          <div className="flex justify-center mb-4">
            <AlertTriangle className="w-16 h-16 text-yellow-500" />
          </div>

          <DialogHeader>
            <DialogTitle className="text-xl font-bold text-white mb-2">
               转 ?
            </DialogTitle>
          </DialogHeader>

          <p className="text-gray-400 mb-6">
            转专 "<strong className="text-white">{exercise?.exercise_name}</strong>" 拽 爪转转.
            <br />
             转  驻注 .
          </p>

          {/* Error message */}
          {error && (
            <p className="text-red-400 text-sm mb-4">{error}</p>
          )}

          <div className="flex gap-3 justify-center">
            <button
              onClick={() => onOpenChange(false)}
              disabled={isDeleting}
              className="px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-700
                         disabled:opacity-50 transition-colors min-h-[44px]"
            >
              
            </button>
            <button
              onClick={handleConfirm}
              disabled={isDeleting}
              className="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700
                         disabled:opacity-50 transition-colors min-h-[44px]"
            >
              {isDeleting ? '拽...' : '拽'}
            </button>
          </div>
        </div>
      </DialogContent>
    </Dialog>
  );
}
```

3. Update frontend/src/pages/LibraryPage.tsx to use the dialogs:

```typescript
import { useEffect, useMemo, useDeferredValue, useState } from 'react';
import { useExerciseStore } from '@/stores/exerciseStore';
import { ExerciseGrid } from '@/components/library/ExerciseGrid';
import { SearchFilters } from '@/components/library/SearchFilters';
import { EditExerciseDialog } from '@/components/library/EditExerciseDialog';
import { DeleteConfirmDialog } from '@/components/library/DeleteConfirmDialog';
import { type Exercise } from '@/lib/api';

export function LibraryPage() {
  const {
    exercises,
    allMuscleGroups,
    allEquipment,
    searchTerm,
    selectedMuscles,
    selectedEquipment,
    isLoading,
    error,
    fetchExercises,
    setSearchTerm,
    toggleMuscleFilter,
    toggleEquipmentFilter,
    clearFilters,
    updateExercise,
    deleteExercise,
  } = useExerciseStore();

  // Dialog state
  const [editExercise, setEditExercise] = useState<Exercise | null>(null);
  const [deleteExerciseTarget, setDeleteExerciseTarget] = useState<Exercise | null>(null);

  // Load exercises on mount
  useEffect(() => {
    fetchExercises();
  }, [fetchExercises]);

  // Defer search/filter to avoid blocking input (per research)
  const deferredSearch = useDeferredValue(searchTerm);
  const deferredMuscles = useDeferredValue(selectedMuscles);
  const deferredEquipment = useDeferredValue(selectedEquipment);

  // Filter exercises client-side (per research recommendation)
  const filteredExercises = useMemo(() => {
    return exercises.filter((ex) => {
      // Search filter
      const nameMatch =
        deferredSearch === '' ||
        ex.exercise_name.toLowerCase().includes(deferredSearch.toLowerCase());

      // Muscle groups filter
      const muscleMatch =
        deferredMuscles.size === 0 ||
        (ex.muscle_groups && ex.muscle_groups.some((mg) => deferredMuscles.has(mg)));

      // Equipment filter
      const equipmentMatch =
        deferredEquipment.size === 0 ||
        (ex.equipment && ex.equipment.some((eq) => deferredEquipment.has(eq)));

      return nameMatch && muscleMatch && equipmentMatch;
    });
  }, [exercises, deferredSearch, deferredMuscles, deferredEquipment]);

  const handleEdit = (exercise: Exercise) => {
    setEditExercise(exercise);
  };

  const handleDelete = (exercise: Exercise) => {
    setDeleteExerciseTarget(exercise);
  };

  const handleSaveEdit = async (
    id: number,
    data: { exercise_name: string; muscle_groups: string[]; equipment: string[] }
  ) => {
    await updateExercise(id, data);
  };

  const handleConfirmDelete = async (id: number) => {
    await deleteExercise(id);
  };

  if (error) {
    return (
      <div className="p-4">
        <div className="bg-red-900/50 text-red-300 rounded-lg p-4 text-center">
          {error}
        </div>
      </div>
    );
  }

  return (
    <div className="p-4 pb-24">
      <h1 className="text-2xl font-bold mb-4 text-white">住驻专转 转专</h1>

      {/* Search and Filters */}
      <div className="mb-6">
        <SearchFilters
          searchTerm={searchTerm}
          onSearchChange={setSearchTerm}
          muscleGroups={allMuscleGroups}
          selectedMuscles={selectedMuscles}
          onToggleMuscle={toggleMuscleFilter}
          equipment={allEquipment}
          selectedEquipment={selectedEquipment}
          onToggleEquipment={toggleEquipmentFilter}
          onClearFilters={clearFilters}
        />
      </div>

      {/* Results count */}
      <p className="text-gray-400 text-sm mb-4">
        {isLoading ? '注...' : `${filteredExercises.length} 转专`}
      </p>

      {/* Exercise Grid */}
      {isLoading ? (
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
          {[1, 2, 3, 4].map((i) => (
            <div key={i} className="bg-gray-900 rounded-xl overflow-hidden animate-pulse">
              <div className="aspect-video bg-gray-800" />
              <div className="p-4 space-y-3">
                <div className="h-6 bg-gray-800 rounded w-3/4" />
                <div className="h-4 bg-gray-800 rounded w-1/4" />
                <div className="flex gap-2">
                  <div className="h-6 bg-gray-800 rounded-full w-16" />
                  <div className="h-6 bg-gray-800 rounded-full w-20" />
                </div>
              </div>
            </div>
          ))}
        </div>
      ) : (
        <ExerciseGrid
          exercises={filteredExercises}
          onEdit={handleEdit}
          onDelete={handleDelete}
        />
      )}

      {/* Edit Dialog */}
      <EditExerciseDialog
        exercise={editExercise}
        open={editExercise !== null}
        onOpenChange={(open) => !open && setEditExercise(null)}
        allMuscleGroups={allMuscleGroups}
        allEquipment={allEquipment}
        onSave={handleSaveEdit}
      />

      {/* Delete Confirmation Dialog */}
      <DeleteConfirmDialog
        exercise={deleteExerciseTarget}
        open={deleteExerciseTarget !== null}
        onOpenChange={(open) => !open && setDeleteExerciseTarget(null)}
        onConfirm={handleConfirmDelete}
      />
    </div>
  );
}
```
  </action>
  <verify>
1. TypeScript compiles: `cd frontend && npx tsc --noEmit`
2. Run dev server, navigate to Library
3. Click edit button on exercise card - edit dialog opens
4. Modify name/muscle groups/equipment and save - changes persist
5. Click delete button - confirmation dialog appears
6. Confirm delete - exercise removed from grid
7. Cancel delete - dialog closes, exercise remains
  </verify>
  <done>Edit and delete dialogs work with full CRUD functionality</done>
</task>

</tasks>

<verification>
1. TypeScript compiles without errors
2. Video autoplay on scroll:
   - Click thumbnail to show video
   - Scroll video into view (50% visible) - autoplays muted
   - Scroll video out of view - pauses
   - Click video to toggle play/pause
3. Edit dialog:
   - Opens with current exercise data populated
   - Can modify name, muscle groups, equipment
   - Save updates exercise in backend and refreshes list
   - Cancel closes dialog without saving
4. Delete dialog:
   - Shows exercise name in confirmation message
   - Confirm deletes exercise from backend and removes from grid
   - Cancel closes dialog without deleting
5. All buttons have 44px minimum touch targets
6. RTL layout works correctly for Hebrew text
</verification>

<success_criteria>
- LIB-05: User can tap exercise to play video
- LIB-06: User can edit exercise metadata
- LIB-07: User can delete exercise
- Videos autoplay when scrolled into view (muted)
- Videos pause when scrolled out of view
- Edit dialog uses existing AutocompleteChips component
- Delete dialog shows confirmation before deletion
- All interactions have loading states and error handling
</success_criteria>

<output>
After completion, create `.planning/phases/04-exercise-library/04-02-SUMMARY.md`
</output>
